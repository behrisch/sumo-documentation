<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Demand Routing by Turn Probabilities | Eclipse SUMO - Documentation</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Demand Routing by Turn Probabilities" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here 12345. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here 12345. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="/sumo-documentation/Demand/Routing_by_Turn_Probabilities/" />
<meta property="og:url" content="/sumo-documentation/Demand/Routing_by_Turn_Probabilities/" />
<meta property="og:site_name" content="Eclipse SUMO - Documentation" />
<script type="application/ld+json">
{"description":"Write an awesome description for your new site here 12345. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","@type":"WebPage","url":"/sumo-documentation/Demand/Routing_by_Turn_Probabilities/","headline":"Demand Routing by Turn Probabilities","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/sumo-documentation/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/sumo-documentation/feed.xml" title="Eclipse SUMO - Documentation" /></head>
<body><header class="site-header">

    <div class="wrapper"><a class="site-title" rel="author" href="/sumo-documentation/">Eclipse SUMO - Documentation</a>
      <img src="https://sumo.dlr.de/favicon.ico" style="width:40px; margin:6px;"><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger" />
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewBox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
              </svg>
            </span>
          </label>
  
        </nav></div>
  </header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Demand Routing by Turn Probabilities</h1>
    <p class="post-meta">
      
    <div align="right"><a href="https://github.com/angelobanse/sumo-documentation/edit/master/en/Demand/Routing_by_Turn_Probabilities.md">Edit on GitHub</a></div></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>The <a href="/JTRROUTER" title="wikilink">JTRROUTER</a> is a routing applications which uses flows and turning percentages at junctions as input. The following parameter must be supplied:</p>

<ul>
  <li>the network to route the vehicles through,</li>
  <li>the description of the turning ratios for the junctions (defaults may be used for this, too), and</li>
  <li>the descriptions of the flows.</li>
</ul>

<p>A call may look like this:</p>

<p><code class="highlighter-rouge">jtrrouter --flow-files=</code><FLOW_DEFS>` --turn-ratio-files=`<TURN_DEFINITIONS>` --net-file=`<SUMO_NET>` \`
`  --output-file=MySUMORoutes.rou.xml --begin `<UINT>` --end `<UINT></UINT></UINT></SUMO_NET></TURN_DEFINITIONS></FLOW_DEFS></p>

<h2 id="turn-definitions">Turn Definitions</h2>

<p>To describe the turn definitions, one has to write an XML file. Within this file, for each interval and each edge the list of percentages to use a certain follower edge has to be given. An example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;turns&gt;
   &lt;interval begin="0" end="3600"&gt;
      &lt;fromEdge id="myEdge0"&gt;
         &lt;toEdge id="myEdge1" probability="0.2"/&gt;
         &lt;toEdge id="myEdge2" probability="0.7"/&gt;
         &lt;toEdge id="myEdge3" probability="0.1"/&gt;
      &lt;/fromEdge&gt;

      ... any other edges ...

   &lt;/interval&gt;

   ... some further intervals ...

&lt;/turns&gt;
</code></pre></div></div>

<p>The snippet defines that vehicles coming at the end of edge “<span class="inlxml">myEdge0</span>” within the time interval between 0s and 3600s will choose the edge “<span class="inlxml">myEdge1</span>” with a probability of 20%, “<span class="inlxml">myEdge2</span>” with a probability of 70% and “<span class="inlxml">myEdge3</span>” with a probability of 10%. Another possibility to save time on preparing the description is to use default values. The parameter can be used to describe the default ratios that will be used for all junctions for all time steps. <TURN_DEFAULTS> is a list of doubles, separated by a ','. To achieve the same behaviour as in the example above, use . The values will be applied to an edge's following edges beginning at the right edge (20%) and ending at the leftmost edge (10%). As the number of possible followers changes for different edges, the values are resampled for edges which number of following edges differs from the number of given turning probability defaults. Given a vehicle using an edge that has two followers would use the follower to the right with 55% probability, the one to the left with 45%.</TURN_DEFAULTS></p>

<h3 id="automatic-generation-of-turn-definitions">Automatic generation of turn definitions</h3>

<p>For automatic, yet artificial, turn definitions generation based on the network structure, see <a href="/Tools/Misc#generateTurnDefs.py" title="wikilink">generateTurnDefs.py</a>.</p>

<h2 id="sinks-definitions">Sinks Definitions</h2>

<p>A vehicle leaves the network as soon as it comes to a sink edge. As not all networks have sink edges defined, one can support a list of edges to be declared as sinks using . You may also add your sink definitions to a turn-file (XML only):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;turns&gt;
   ... some further turning definitions as above ...

   &lt;sink edges="&lt;EDGE_ID&gt;[ &lt;EDGE_ID&gt;]*"/&gt;
   ... further sink definitions ...

&lt;/turns&gt;
</code></pre></div></div>

<p>If you do not define sinks, the option may be used to declare all edge as possible sinks.</p>

<h2 id="flow-definitions">Flow Definitions</h2>

<p>The <a href="/Definition_of_Vehicles,_Vehicle_Types,_and_Routes#Repeated_vehicles_.28Flows.29" title="wikilink">definitions of the flow</a> is the same as for the <a href="/DUAROUTER" title="wikilink">DUAROUTER</a> with just a single difference: as it is not known where the vehicle will leave the network as the route it uses is randomly computed, the route must be specified using attribute <em>from</em> and attribute <em>to</em> must be omitted:</p>

<p><code class="highlighter-rouge"> </code><flow id="0" from="A" begin="0" end="3600" probability="0.5"></flow></p>

<h2 id="additional-options">Additional Options</h2>

<p>As theoretically a route may get infinitely long when a vehicle is forced to take always the same direction, it is possible to limit the route’s size using optoin . This factor, multiplied with the number of the used network’s edges is the maximum number of edges a route may have. With the default of 2.0, a route may contain twice as many edges as the network has. Any route longer than this size will be marked as invalid. We assume that for each network this number has to be chosen again.</p>

  </div><a class="u-url" href="/sumo-documentation/Demand/Routing_by_Turn_Probabilities/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
    <data class="u-url" href="/sumo-documentation/"></data>
  
    <div class="wrapper">
  
      <div class="footer-col-wrapper">
        <div class="footer-col one-half">
        <h2 class="footer-heading">Eclipse SUMO - Documentation</h2>
          <ul class="contact-list">
            <li class="p-name">Eclipse SUMO - Documentation</li></ul>
        </div>
  
        <div class="footer-col one-half">
          <p>Write an awesome description for your new site here 12345. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
        </div>
  
        <div class="social-links"><ul class="social-media-list"><li><a href="https://www.twitter.com/eclipseSUMO"><svg class="svg-icon"><use xlink:href="/sumo-documentation/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">eclipseSUMO</span></a></li></ul>
</div>
      </div>
  
    </div>
  
  </footer></body>

</html>
