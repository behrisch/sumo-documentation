<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Tutorials Driving in Circles | Eclipse SUMO - Documentation</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Tutorials Driving in Circles" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here 12345. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here 12345. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="/sumo-documentation/Tutorials/Driving_in_Circles/" />
<meta property="og:url" content="/sumo-documentation/Tutorials/Driving_in_Circles/" />
<meta property="og:site_name" content="Eclipse SUMO - Documentation" />
<script type="application/ld+json">
{"description":"Write an awesome description for your new site here 12345. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","@type":"WebPage","url":"/sumo-documentation/Tutorials/Driving_in_Circles/","headline":"Tutorials Driving in Circles","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/sumo-documentation/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/sumo-documentation/feed.xml" title="Eclipse SUMO - Documentation" /></head>
<body><header class="site-header">

    <div class="wrapper"><a class="site-title" rel="author" href="/sumo-documentation/">Eclipse SUMO - Documentation</a>
      <img src="https://sumo.dlr.de/favicon.ico" style="width:80px;"><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger" />
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewBox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
              </svg>
            </span>
          </label>
  
        </nav></div>
  </header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Tutorials Driving in Circles</h1>
    <p class="post-meta">
      
    <div align="right"><a href="https://github.com/angelobanse/sumo-documentation/edit/master/en/Tutorials/Driving_in_Circles.md">Edit on GitHub</a></div></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>In this tutorial we will build a simple circular net with netedit and use <a href="/Simulation/Rerouter" title="wikilink">rerouters</a> to make vehicles drive in circles. All definition files can also be found in the /docs/tutorial/circles directory.</p>

<h1 id="build-a-network">Build a network</h1>

<p>First open <a href="/NETEDIT" title="wikilink">NETEDIT</a> and create edges to form a closed loop. To do that press <code class="highlighter-rouge">Ctrl-A</code> to create a new network and then press <code class="highlighter-rouge">e</code> to enter the edge editing mode. Now create a closed loop of edges (you might consider to check ‘chain’ just right from the edit-mode selection, see figure).</p>

<table>
  <tbody>
    <tr>
      <td>[thumb</td>
      <td>upright=0.7</td>
      <td>A circular net](/File:CircleNet.PNG “wikilink”)</td>
    </tr>
  </tbody>
</table>

<p>The result should look more or less like shown in the figure. The important thing is the circular shape. Now save the network somewhere (<code class="highlighter-rouge">Ctrl-Shift-S</code>) in an empty directory (we will refer to that place by <code class="highlighter-rouge">baseDir</code>). As name for the created net-file type in <code class="highlighter-rouge">circles.net.xml</code>.</p>

<h1 id="create-vehicles-and-run-sumo">Create vehicles and run SUMO</h1>

<p>In the <code class="highlighter-rouge">baseDir</code> create two empty text-files, call them <code class="highlighter-rouge">circles.rou.xml</code> and <code class="highlighter-rouge">circles.sumocfg</code>. These files will define our vehicles and the run configuration.</p>

<p>First, we edit <code class="highlighter-rouge">circles.rou.xml</code> and define a vehicle flow of five standard passenger cars. The file contents should look like this:</p>

<p><code class="highlighter-rouge">&lt;routes&gt;</code>
<code class="highlighter-rouge">   &lt;vType id="car" type="passenger" length="5" accel="3.5" decel="2.2" sigma="1.0"/&gt;</code>
<code class="highlighter-rouge">   &lt;flow id="carflow" type="car" beg="0" end="0" number="5"/&gt;</code>
<code class="highlighter-rouge">&lt;/routes&gt;</code></p>

<p>For further explanation of how to define flows and vTypes see the respective Wiki-pages: <a href="/Demand/Shortest_or_Optimal_Path_Routing#Flow_Definitions" title="wikilink">Flow Definitions</a> and <a href="/Definition_of_Vehicles,_Vehicle_Types,_and_Routes#Vehicle_Types" title="wikilink">Vehicle Types</a>.</p>

<p>To use the route-file and the generated net-file with SUMO, we edit the configuration-file <code class="highlighter-rouge">circles.sumocfg</code> to tell SUMO where it finds vehicle and net definitions:</p>

<p><code class="highlighter-rouge">&lt;configuration&gt;</code>
<code class="highlighter-rouge">    &lt;input&gt;</code>
<code class="highlighter-rouge">       &lt;net-file value="circles.net.xml"/&gt;</code>
<code class="highlighter-rouge">       &lt;route-files value="circles.rou.xml"/&gt;</code>
<code class="highlighter-rouge">    &lt;/input&gt;</code>
<code class="highlighter-rouge">&lt;/configuration&gt;</code></p>

<table>
  <tbody>
    <tr>
      <td>[thumb</td>
      <td>upright=0.7</td>
      <td>First attempt to run the simulation](/File:StartAttempt1.PNG “wikilink”)</td>
    </tr>
  </tbody>
</table>

<p>Now let us try to start SUMO with the config that we have just created. To do so either double-click on the configuration-file <code class="highlighter-rouge">circles.sumocfg</code> (under Windows, if your installation was done with default settings) or change to the <code class="highlighter-rouge">baseDir</code> in a terminal and start SUMO (with graphical user interface) there by typing <code class="highlighter-rouge">sumo -c circles.sumocfg</code>. (If this does not start SUMO, you might have to add the sumo/bin directory to your PATH?)</p>

<p>Did it work? No.</p>

<p>Let us have a look at the Message Window at the bottom of the GUI to endeavor what went wrong (by the way: the Message Window is often a very useful resource for information for setting up a simulation take a look at it first, if you run into problems).</p>

<p>It says: <code class="highlighter-rouge">Error: The route for flow 'carflow' has no edges.</code> This means that SUMO does not know from where to where the vehicles of the flow we declared in <code class="highlighter-rouge">circles.rou.xml</code> should take. To do this, we need to add attributes <code class="highlighter-rouge">to</code> and <code class="highlighter-rouge">from</code>, and provide corresponding edge-ids to the flow.</p>

<table>
  <tbody>
    <tr>
      <td>[thumb</td>
      <td>upright=0.7</td>
      <td>Renaming an edge in netedit](/File:nameEdges.PNG “wikilink”)</td>
    </tr>
  </tbody>
</table>

<p>The edge-ids can be inspected and modified in netedit: open your network-file <code class="highlighter-rouge">circles.net.xml</code> and press <code class="highlighter-rouge">i</code> to enter the inspect-mode. Left-click on an arbitrary edge and rename it to <code class="highlighter-rouge">edge1</code>. Left-click on a different edge and rename it to <code class="highlighter-rouge">edge2</code>. Then save your network (<code class="highlighter-rouge">Ctrl-s</code>).</p>

<p>Now we add the from-edge and the to-edge to the flow in <code class="highlighter-rouge">circles.rou.xml</code>:</p>

<p><code class="highlighter-rouge"> ...</code>
<code class="highlighter-rouge">    &lt;flow id="carflow" type="car" beg="0" end="0" number="5" from="edge1" to="edge2"/&gt;</code>
<code class="highlighter-rouge"> ...</code></p>

<table>
  <tbody>
    <tr>
      <td>[thumb</td>
      <td>upright=0.7</td>
      <td>Running five cars on the circular net](/File:running1.PNG “wikilink”)</td>
    </tr>
  </tbody>
</table>

<p>Let’s try to run SUMO again. The window should now show the network you have created before in netedit and you can start the simulation by clicking on the play button (<a href="/Image:play.gif" title="wikilink">Image:play.gif</a>) or the step button (<a href="/Image:step.gif" title="wikilink">Image:step.gif</a>). If you use <a href="/Image:play.gif" title="wikilink">Image:play.gif</a>, be sure to adjust the value for the animation delay time between consecutive simulation steps (the field labeled “Delay (ms):”, see figure). Otherwise SUMO will run the simulation as fast as possible and you will probably see nothing happening at all. (Note that the the figure uses the style “real world” from the representation-dropdow-menu in the toolbar.)</p>

<p>The cars will drive from the beginning of edge1 to the end of edge2 and then leave the net (just a side remark: you can control the positions of departure and arrival by additional arguments to the flow, see <a href="/Demand/Shortest_or_Optimal_Path_Routing#Flow_Definitions" title="wikilink">Flow Definitions</a>). The simulation ends when all vehicles have left the net.</p>

<h1 id="circular-rerouting">Circular rerouting</h1>

<p>Now let us make the vehicles drive in circles around the track again and again. To this end we will create a rerouter</p>

<p>Since in SUMO the additional elements are not considered as elements of the net, we have to specify them in a separate file (the “additionals-file”). Create and open a file <code class="highlighter-rouge">circles.add.xml</code> in the <code class="highlighter-rouge">baseDir</code> and add the following xml-code (see <a href="/Simulation/Rerouter#Assigning_a_new_Destination" title="wikilink">Rerouter/Assigning a new Destination</a> for details):</p>

<p><code class="highlighter-rouge">&lt;additionals&gt;</code>
<code class="highlighter-rouge">    &lt;rerouter id="rerouter_0" edges="edge1"&gt;    </code>
<code class="highlighter-rouge">        &lt;interval end="1e9"&gt;</code>
<code class="highlighter-rouge">           &lt;destProbReroute id="edge2"/&gt;</code>
<code class="highlighter-rouge">        &lt;/interval&gt;</code>
<code class="highlighter-rouge">    &lt;/rerouter&gt;</code>
<code class="highlighter-rouge">    &lt;rerouter id="rerouter_1" edges="edge2"&gt;</code>
<code class="highlighter-rouge">        &lt;interval end="1e9"&gt;</code>
<code class="highlighter-rouge">           &lt;destProbReroute id="edge1"/&gt;</code>
<code class="highlighter-rouge">        &lt;/interval&gt;</code>
<code class="highlighter-rouge">    &lt;/rerouter&gt;</code>
<code class="highlighter-rouge">&lt;/additionals&gt;</code></p>

<p>Then we have to tell SUMO to include the rerouters into the simulation by adding a line to the config <code class="highlighter-rouge">circles.sumocfg</code>. Within the <input /> tag add a child:</p>

<additional-files value="circles.add.xml" />

<p>This will add two (destination-)rerouters to our network making the vehicles go around the circle until the given end time (i.e., until one hundred million seconds have passed). Effectively, each rerouter will update the destination for each vehicle entering its edge (specified by its <code class="highlighter-rouge">edge</code>-attribute) and set it to the edge given in the <code class="highlighter-rouge">id</code>-attribute of the <code class="highlighter-rouge">destProbReroute</code>-element. So as soon as a vehicle enters <code class="highlighter-rouge">edge1</code> (its current destination), its destination will be updated to <code class="highlighter-rouge">edge2</code> and vice-versa, when entering <code class="highlighter-rouge">edge2</code> it will be rerouted towards <code class="highlighter-rouge">edge1</code>, thus following a circular route.</p>

<h1 id="exercises">Exercises</h1>

<table>
  <tbody>
    <tr>
      <td>Here are some simple ideas to extend this toy example: [thumb</td>
      <td>upright=0.5</td>
      <td>A net with two loops](/File:twoloops.png “wikilink”)</td>
    </tr>
  </tbody>
</table>

<ol>
  <li>add more lanes in netedit and another vehicle flow with faster cars to observe SUMO’s overtaking behavior.</li>
  <li>add a scooter flow and use the <a href="/Simulation/SublaneModel" title="wikilink">Sublane Model</a> to observe SUMO’s sublane model.</li>
  <li>add another loop (see figure) and trigger the next loop for each vehicle by a probabilistic choice of the destination (<a href="/Simulation/Rerouter#Assigning_a_new_Destination" title="wikilink">Rerouter/Assigning a new Destination</a>), observe merging at the location where both loops are connected.</li>
  <li>Insert more vehicles, lower the simulation <a href="/Simulation/Basic_Definition#Defining_the_Time_Step_Length_and_Integration_Method" title="wikilink">time-step length</a> and try to observe stop-and-go waves, experiment with different <a href="/Car-Following-Models" title="wikilink">car-following models</a>, <a href="/SUMO-GUI#Vehicle_Visualisation_Settings" title="wikilink">color the vehicles</a> by speed.</li>
</ol>

<p>If you create solutions for the exercises post them on this page!</p>

<p>Back to <a href="/Tutorials" title="wikilink">Tutorials</a></p>

  </div><a class="u-url" href="/sumo-documentation/Tutorials/Driving_in_Circles/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/sumo-documentation/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Eclipse SUMO - Documentation</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Eclipse SUMO - Documentation</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.twitter.com/eclipseSUMO"><svg class="svg-icon"><use xlink:href="/sumo-documentation/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">eclipseSUMO</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here 12345. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
