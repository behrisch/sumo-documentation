<p>This document describes how to install SUMO on Linux from sources. If you don’t want to <strong>extend</strong> SUMO, but merely <strong>use</strong> it, you might want to <a href="/Installing" title="wikilink">download one of our pre-built binary packages</a> instead.</p>

<p>To be able to run SUMO on Linux, just follow these four steps:</p>

<ol>
  <li>Install all of the required tools and libraries</li>
  <li>Get the source code</li>
  <li>Build the SUMO binaries</li>
  <li>Install the SUMO binaries to another path (optional)</li>
</ol>

<p>Each of these steps is outlined below.</p>

<h2 id="installing-required-tools-and-libraries">Installing required tools and libraries</h2>

<ul>
  <li>For the build infrastructure you will need a moderately recent g++ (4.8 will do) or clang++ together with the autotools (autoconf / automake).</li>
  <li>The libraries needed are the Fox Toolkit in version 1.6.x, Xerces-C, Proj and GDAL. To compile you will need the devel versions of all packages. For openSUSE this means installing libxerces-c-devel, libproj-devel, libgdal-devel, and fox16-devel. There are some <a href="/Installing/Linux_Build_Libraries" title="wikilink">platform specific and manual build instructions for the libraries</a></li>
  <li>Optionally you may want to add ffmpeg-devel (for video output), libOpenSceneGraph-devel (for the experimental 3D GUI) and python-devel (for running TraCI pythons scripts without a socket connection)</li>
</ul>

<h2 id="getting-the-source-code">Getting the source code</h2>

<h3 id="release-version-or-nightly-tarball">release version or nightly tarball</h3>

<p>Download [<a href="http://prdownloads.sourceforge.net/sumo/sumo-src-%7B%7BVersion%7D">http://prdownloads.sourceforge.net/sumo/sumo-src-%7B%7BVersion%7D</a>}.tar.gz?download sumo-src-.tar.gz] or <a href="http://sumo.dlr.de/daily/sumo-src-git.tar.gz">http://sumo.dlr.de/daily/sumo-src-git.tar.gz</a></p>

<p><code class="highlighter-rouge">tar xzf sumo-src-</code><version>`.tar.gz`
`cd sumo-`<version>`/`</version></version></p>

<h3 id="repository-checkout">repository checkout</h3>

<p>The following commands should be issued:</p>

<p><code class="highlighter-rouge">git clone --recursive </code><a href="https://github.com/eclipse/sumo"><code class="highlighter-rouge">https://github.com/eclipse/sumo</code></a>
<code class="highlighter-rouge">cd sumo</code>
<code class="highlighter-rouge">git fetch origin refs/replace/*:refs/replace/*</code></p>

<p>The additional fetch of the replacements is necessary to get a full local project history.</p>

<h3 id="definition-of-sumo_home">Definition of SUMO_HOME</h3>

<p>Before compiling is advisable (essential if you want to use Clang) to define the environment variable SUMO_HOME. Assuming that you placed SUMO in the folder “*/home/<user>/sumo-<version>*”, if you want to define only for the current session, type in the console</version></user></p>

<p><code class="highlighter-rouge">export SUMO_HOME=</code>“<code class="highlighter-rouge">/home/</code><user>`/sumo-`<version>”</version></user></p>

<p>If you want to define for all sessions (i.e. for every time that you run your Linux distribution), go to your HOME folder, and find one of the next tree files (depending of your Linux distribution): <strong>.bash_profile</strong>, <strong>.bash_login</strong> or <strong>.profile</strong> (Note that these files can be hidden). Then edit the file, add the line from above at the end and restart your session.</p>

<p>You can check that SUMO_HOME was successfully set if you type</p>

<p><code class="highlighter-rouge">echo $SUMO_HOME</code></p>

<p>and console shows “/home/<user>/sumo-<version>”</version></user></p>

<h2 id="building-the-sumo-binaries-with-autotools">Building the SUMO binaries with autotools</h2>

<p>To build from a checkout the <a href="http://en.wikipedia.org/wiki/GNU_build_system">GNU autotools</a> are needed. The call to the autotools is hidden in Makefile.cvs.</p>

<p><code class="highlighter-rouge">make -f Makefile.cvs</code></p>

<p><code class="highlighter-rouge">./configure [options]</code>
<code class="highlighter-rouge">make</code></p>

<p>If you built the required libraries manually, you may need to tell the configure script where you installed them (e.g. <strong>–with-xerces=…</strong>). Please see the above <a href="/Installing/Linux_Build_Libraries" title="wikilink">instructions on installing required tools and libraries</a> to find out how to do that.</p>

<p>Other common options to ./configure include <strong>–prefix=$HOME</strong> (so installing SUMO means copying the files somewhere in your home directory), <strong>–enable-debug</strong> (to build a version of SUMO that’s easier to debug), and <strong>–with-python</strong> which enables the direct linking of python.</p>

<p>For additional options please see</p>

<p><code class="highlighter-rouge">./configure --help</code></p>

<p>After doing <strong>make</strong> you will find all binaries in the bin subdir without the need for installation. You may of course do a make install to your intended destination as well, see below.</p>

<h3 id="building-with-clang">Building with clang</h3>

<p>If you want to use a different compiler (just for the fun of it or because it has additional features) you can enable it at configure time. Our current clang configuration for additional static code checking looks like this:</p>

<p><code class="highlighter-rouge">./configure CXX=clang++ CXXFLAGS=</code>“<code class="highlighter-rouge">-stdlib=libstdc++</code><code class="highlighter-rouge"> </code><code class="highlighter-rouge">-fsanitize=undefined,address,integer,unsigned-integer-overflow</code><code class="highlighter-rouge"> </code><code class="highlighter-rouge">-fno-omit-frame-pointer</code><code class="highlighter-rouge"> </code><code class="highlighter-rouge">-fsanitize-blacklist=$PWD/build/clang_sanitize_blacklist.txt</code>”</p>

<p>You may of course leave out all the sanitizer-checks you don’t want but the stdlib option has to be set. The blacklist filters out a known bug in the cstdlib. For details see the clang documentation.</p>

<h3 id="additional-notes-for-cygwin-users">Additional notes for Cygwin users</h3>

<p>At the moment GUI building is still troublesome. It depends whether you want to use the X-Server or native Windows GUI. We tried native Windows GUI only and had to change the installed libFOX-1.4.la such that it contains</p>

<p><code class="highlighter-rouge">dependency_libs=' -lgdi32 -lglaux -ldl -lcomctl32 -lwsock32 -lwinspool -lmpr</code>
<code class="highlighter-rouge">-lpthread -lpng /usr/lib/libtiff.la /usr/lib/libjpeg.la -lz -lbz2 -lopengl32 -lglu32'</code></p>

<p>Your mileage may vary.</p>

<h2 id="building-the-sumo-binaries-with-cmake">Building the SUMO binaries with cmake</h2>

<p>To build with cmake version 3 or higher is required.</p>

<p>Create a build folder for cmake (in the sumo root folder)</p>

<p><code class="highlighter-rouge"> mkdir build/cmake-build</code>
<code class="highlighter-rouge"> cd build/cmake-build</code></p>

<p>then build sumo with the bare minimum of options use (fully EPL2 compatible):</p>

<p><code class="highlighter-rouge"> cmake ../..</code></p>

<p>after this is finished, run</p>

<p><code class="highlighter-rouge"> make</code></p>

<p>to use additional features (gdal, gl2ps,…) set another option when building:</p>

<p><code class="highlighter-rouge"> cmake  -D CHECK_OPTIONAL_LIBS=true ../..</code></p>

<h2 id="installing-the-sumo-binaries">Installing the SUMO binaries</h2>

<p>This (optional) step will copy the SUMO binaries to another path, so that you can delete all source and intermediate files afterwards. If you do not want (or need) to do that, you can simply skip this step and run SUMO from the bin subfolder (bin/sumo-gui and bin/sumo).</p>

<p>If you want to install the SUMO binaries, run</p>

<p><code class="highlighter-rouge">make install</code>
<code class="highlighter-rouge"> </code></p>

<h2 id="troubleshooting">Troubleshooting</h2>

<h3 id="problems-with-aclocalm4-and-libtool">Problems with aclocal.m4 and libtool</h3>

<p>If you’re experiencing problems with aclocal.m4 definitions and see</p>

<p><code class="highlighter-rouge"> </code>“<code class="highlighter-rouge">You</code><code class="highlighter-rouge"> </code><code class="highlighter-rouge">should</code><code class="highlighter-rouge"> </code><code class="highlighter-rouge">recreate</code><code class="highlighter-rouge"> </code><code class="highlighter-rouge">aclocal.m4</code>”</p>

<p>during the build, you should run the following commands:</p>

<p><code class="highlighter-rouge">aclocal</code>
<code class="highlighter-rouge">libtoolize --force</code>
<code class="highlighter-rouge">autoheader</code>
<code class="highlighter-rouge">autoconf</code>
<code class="highlighter-rouge">./configure [your configure options]</code>
<code class="highlighter-rouge">make [install]</code></p>

<h3 id="unresolved-references-to-opengl-functions">Unresolved references to openGL-functions</h3>

<p>Build reports unresolved references to openGL-functions, saying things such as</p>

<p><code class="highlighter-rouge">"./utils/glutils/libglutils.a(GLHelper.o): In function</code>
<code class="highlighter-rouge">`GLHelper::drawOutlineCircle(float, float, int, float, float)':</code>
<code class="highlighter-rouge">/home/smartie/sumo-0.9.5/src/utils/glutils/GLHelper.cpp:352:</code>
<code class="highlighter-rouge">undefined reference to `glEnd'"</code></p>

<p>SUMO needs FOX-toolkit to be build with openGL-support enabled. Do this by compiling FOX-toolkit as following:</p>

<p><code class="highlighter-rouge">tar xzf fox-1.4.34.tar.gz</code>
<code class="highlighter-rouge">cd fox-1.4.34</code>
<code class="highlighter-rouge">./configure --with-opengl=yes --prefix=$HOME &amp;&amp; make install</code></p>

<hr />

<p><strong>Further comment from Michael Behrisch ([sumo-user], 4.4.2007):</strong> <em>Probably there is something wrong with your OpenGL installation. Make sure you have the libGL.so and libGLU.so which are most likely symbolic links to libGL.so.1.2 or something like this. They should appear in /usr/lib and case does matter (so “libgl.so” won’t do).</em></p>

<h3 id="problems-with-the-socket-subsystem">Problems with the socket subsystem</h3>

<p>Problem:</p>

<p><code class="highlighter-rouge">recv ./foreign/tcpip/libtcpip.a(socket.o)  (symbol belongs to implicit dependency /usr/lib/libsocket.so.1)</code></p>

<p>Solution: <a href="http://lists.danga.com/pipermail/memcached/2005-September/001611.html">http://lists.danga.com/pipermail/memcached/2005-September/001611.html</a></p>

<h3 id="ld-cannot-find-an-existing-library-fedora-23">ld cannot find an existing library (Fedora-23)</h3>

<p>Problem:</p>

<p><code class="highlighter-rouge">/usr/bin/ld: cannot find -lfreetype</code>
<code class="highlighter-rouge">ls -lah /usr/lib64/libfreetype*</code>
<code class="highlighter-rouge"> lrwxrwxrwx. 1 root root   21 Jul 28 15:54 /usr/lib64/libfreetype.so.6 -&gt; libfreetype.so.6.12.0</code>
<code class="highlighter-rouge"> lrwxr-xr-x. 1 root root 689K Jul 28 15:54 /usr/lib64/libfreetype.so.6.12.0</code></p>

<p>Solution: Install the dev package; for fedora:</p>

<p><code class="highlighter-rouge">sudo yum install freetype-devel</code></p>

<p>For details see <a href="http://stackoverflow.com/questions/335928/ld-cannot-find-an-existing-library">stackoverflow</a> discussion.</p>
